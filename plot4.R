png('plot4.png',width=480,height=480)
data<-read.table('household_power_consumption.txt',sep=';',header=T,na.strings='?',stringsAsFactors=F)
data_sub<-subset(data,data$Date=='1/2/2007'|data$Date=='2/2/2007')
time<-paste(as.Date(data_sub$Date,format='%d/%m/%Y'),data_sub$Time)
timex<-as.POSIXct(time)
TT<-unclass(timex)
N<-nrow(data_sub)
par(mfrow=c(2,2))
plot(TT,data_sub$Global_active_power,xaxt='n',type='l',cex=1,lty=1,xlab='',ylab='Global Active Power (kilowatts)')
axis(1,labels='Thu',at=unclass(timex)[1],las=1)
axis(1,labels='Fri',at=unclass(timex)[N/2],las=1)
axis(1,labels='Sat',at=unclass(timex)[N],las=1)
plot(TT,data_sub$Voltage,xaxt='n',type='l',cex=1,lty=1,xlab='datetime',ylab='Voltage')
axis(1,labels='Thu',at=unclass(timex)[1],las=1)
axis(1,labels='Fri',at=unclass(timex)[N/2],las=1)
axis(1,labels='Sat',at=unclass(timex)[N],las=1)
plot(TT,data_sub$Sub_metering_1,xaxt='n',type='l',cex=1,lty=1,xlab='',ylab='Energy sub metering',col='black',ylim=c(0,38))
par(new=T)
plot(TT,data_sub$Sub_metering_2,xaxt='n',type='l',cex=1,lty=1,xlab='',ylab='',col='red',ylim=c(0,38))
par(new=T)
plot(TT,data_sub$Sub_metering_3,xaxt='n',type='l',cex=1,lty=1,xlab='',ylab='',col='blue',ylim=c(0,38))
axis(1,labels='Thu',at=unclass(timex)[1],las=1)
axis(1,labels='Fri',at=unclass(timex)[N/2],las=1)
axis(1,labels='Sat',at=unclass(timex)[N],las=1)
legend('topright',lty=1,col=c('black','red','blue'),legend=c('Sub_metering_1','Sub_metering_2','Sub_metering_3'),cex=0.7,bty='n')
plot(TT,data_sub$Global_reactive_power,xaxt='n',type='l',cex=1,lty=1,xlab='datetime',ylab='Global_reactive_power')
axis(1,labels='Thu',at=unclass(timex)[1],las=1)
axis(1,labels='Fri',at=unclass(timex)[N/2],las=1)
axis(1,labels='Sat',at=unclass(timex)[N],las=1)
dev.off()